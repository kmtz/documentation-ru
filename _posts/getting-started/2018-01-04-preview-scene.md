---
date: 2018-01-01
title: Предпросмотр сцены
description: What you can see in a scene's preview
redirect_from:
  - /documentation/preview-scene/
categories:
  - getting-started
type: Document
set: getting-started
set_order: 3
tag: introduction
---

Как только вы завершили [создание сцены]({{ site.baseurl }}{% post_url /getting-started/2018-01-03-create-scene %}) ) или загрузили [готовую сцену]({{ site.baseurl }}{% post_url /examples/2018-01-08-sample-scenes %}) ) вы можете запустить предпросмотр.

## Прежде чем начать

Пожалуйста, убедитесь что вы уже установили консольные утилиты (CLI) Decentraland. В Mac OS, вы можете сделать это, запустив команду:

```bash
npm install -g decentraland
```

Смотрите [инструкцию по установке]({{ site.baseurl }}{% post_url /getting-started/2018-01-01-installation-guide %}), чтобы получить больше информации и инструкции по установке в ОС Windows и Linux.

## Предпросмотр локальной сцены

Для предпросмотра локальной сцены запустите эту команду в директории с проектом:

```bash
dcl start
```

Все завимости, необходимые для запуска сцены, устанавливаются автоматически, после чего запустится окно браузера с предпросмотром. Эта команда запускает веб-сервер на вашем компьютере и браузер сразу открывает окно с нужным адресом.

Каждый раз когда вы вносите изменения в вашу сцену, предпросмотр подхватывает эти изменения и обновляет сцену автоматически, так что вам не нужно запускать эту команду снова.

## Предпросмотр удаленной сцены

Для предпросмотра удаленной сцены вам необходимо запустить сервер  WebSockets на вашем компьютере. Чтобы это сделать:

Запустите следующие команды в директории с вашей сценой:

```bash
cd server

npm install
# npm will find your dependencies

npm run build
# npm will build the socket server

npm start
# now the port is running
```

Как только веб-сервер запустится, команда покажет вам на каком порту он запущен, запомните его. Скорее всего это будет порт 8087.

Убедитесь что именно этот порт указан в файле_scene.json_ в качестве порта websocket, если нет - поменяйте его на тот порт, на котором запустился сервер.

Когда websocket сервер запущен и сцена настроена для работы с ним, вы можете запустить предпросмотр этой сцены локально, на вашем компьютере.

Запустите эту команду из директории со сценой:

```bash
dcl start
```

Все необходимые зависимости будут установлены автоматически, после чего будет открыто окно браузера с вашей сценой.

Вы так-же можете открыть свою сцену в других вкладках браузера для имитации других пользователей. Пользователи не будут видеть аватары друг друга в предпросмотре, однако они будут видеть маркер, обозначающий другого пользователя. Если действия какого-то пользователя влияют на сцену, которая запущена на сервере, все пользователи должны увидеть эти изменения.

> Примечание: На данный момент предпросмотр удаленных сцен не делает автоматического обновления сцены при ее изменении, как это происходит для локальных сцен. Каждый раз, когда вы вносите изменения, вы должны перезапускать сервер. Мы советуем начинать разработку с локальной сцены и только потом делать ее удаленной, когда сама сцена практически готова.

## Загрузка сцены в Decentraland

Когда ваша сцена вас полностью устраивает, вы можете загрузить и опубликовать ее в Decentraland, читайте про [публикацию]({{ site.baseurl }}{% post_url /getting-started/2018-01-07-publishing %}) ), чтобы узнать, как это сделать.

## Параметры команды предпросмотра

Вы можете задать следующие параметры команде `dcl start`, для изменения поведения по умолчанию:

- `--no-browser` команда не будет автоматически запускать веб-браузер.
- `--port` задаст определенный порт, на котором будет запущена сцена. Если параметр не указан, сцена будет запущена на одном из свободных портов.

<!--
Seems to be removed:

- `--skip` to skip the confirmation prompt.
-->

> Для просмотра старых сцен, которые создавались для старой версии SDK вам нужно поставить последние версии пакетов `decentraland-api` и `decentraland-rpc`. Для того, чтобы проверить текущую версию запустите команду `dcl -v`

## Как пользоваться предпросмотром сцены

В режиме предпросмотра выводится ряд полезной информации для отладки, так же доступны различные инструменты, которые помогают понять процесс отрисовки сцены. В режиме предпросмотра вы будете видеть границы сцены, а так же ее ориентацию в пространстве.

Для выхода из режима предпросмотра вы можете нажать клавишу Esc, вы снова сможете пользоваться мышкой, как обычно.

Если ваша сцена пишет какую-либо информацию в консоль (с помощью `console.log()`), вы можете просматривать эти сообщения в JS консоли вашего браузера. Например, в браузере Chrome вы можете открыть ее через `View > Developer > JavaScript console` (или просто нажав F12 и перейдя во вкладку консоль)

В верхнем левом углу будет отображаться дополнительная информация:

- _FPS_ : количество кадров в секунду
- _MS_ : задержка ping в милисекундах
- _MB_ : использование памяти в мегабайиах

Нажмите на график для переключения между этими величинами.

## Предпросмотр размера сцены

Размер сцены в режиме предпросмотра зависит от ее параметров, которые вы установили при инициализации сцены в CLI. ПО умолчанию размер сцены равен одному участку (10 x 10 метров).

Если вы создаете сцену для загрузки на площадку, состоящую из нескольких участков (estate), тогда вы можете отредактировать файл _scene.json_ в соответствии с этим указав несколько учасков в поле "parcels".

```json
 "scene": {
    "parcels": [
      "0,0",
      "0,1",
      "1,0",
      "1,1"
    ],
    "base": "0,0"
  },
```

## Отладка сцены

Если движок не может отрисовать вашу сцену, то вы увидите болшой белый куб, занимающий все пространство сцены.

Если это произошло, есть несколько мест, где вы сможете найти журнал ошибок, чтобы понять что же пошло не так:

1.  Проверьте ваш код на наличие синтаксических или логических ошибок.
2.  Проверьте что выводит в консоль команда `dcl start`
3.  Проверьте консоль JavaScript в вашем браузере на предмет ошибок. Например, в браузере Chrome вы можете открыть ее через `View > Developer > JavaScript console` (или просто нажав F12 и перейдя во вкладку консоль)
4.  Если вы запускаете предпросмотр удаленной сцены, проверьте нет ли ошибок в консоли, в которой у вас запущена команда `npm start`, запускающая сервер.

Если ваша сцена превышает какое-либо из [ограничений]({{ site.baseurl }}{% post_url /development-guide/2018-01-06-scene-limitations %}), установленных для сцен, например, если в сцене слишком много полигонов, то она не будет отрисована. В данном случае вы увидите ошибку в самом предпросмотре, на месте, где должен быть ваш объект.

Если объекты находятся вне сцены или выходят за ее границы, то они будут мигать красным цветом, чтобы сигнализировать об этом. Все объекты в вашей сцене должны укладываться в заданные лимиты. Хотя сцена и будет отрисована в локальном окружении, вы не сможете загрузить ее в Decentraland.

Вы так же можете добавить команды `console.log()` и `console.trace()` в ваш код, чтобы они выводили информацию для отладки в консоль JavaScript.

Вы так же можете использовать вкладку `sources` в инструментарии разработчика браузера для добавления точек останова и временной остановки кода в процессе тестирования вашей сцены.

## Предпросмотр collision meshes

В режиме предпросмотра вы можете нажать клавишу  `c`  для просмотра collision meshes (границы объекта, через которые персонаж не может пройти) загруженные в модели glTF в вашей сцене. Обычно они не видимы и определяют где персонаж может ходить, а где - нет.

![](/images/media/collision-meshes.png)

Collision meshes могуда быть добавлены в любую модель в программе для 3Д моделирования, такое как Blender. В большие модели, например здания, часто добавляют эти границы, делая их значительно проще, чем отрисовываемую часть, для улучшения производительности. Например, на лестнице не отрисовывают каждую ступеньку, а делают collision mesh в виде обычной наклонной плоскости и персонаж может просто зайти по этой лестнице, ему не нужно будет запрыгивать на каждую ступеньку.

## Просмотр кубической границы объекта

В режиме предпросмотра вы можете нажать `b` чтобы посмотреть куб, в границах которого находится отрисованный объект. Кубические границы показывают место, занимаемое объектом, что бывает особенно полезно для просмотра границ невидимых объектов..

## Использование тестовой сети Ethereum

Если в вашей сцене вы используете транзакции в сети Ethereum, например вы требуете оплату в MANA для того, чтобы открыть дверь, необязательно использовать реальные токены в режиме предпросмотра.

Для этого следует использовать сеть _Ethereum Ropsten test network_ и переводить ненастоящие токены мана. Для использования тестовой сети, вам нужно в настройках расширения MetaMask выбрвть сеть _Ropsten test network_ вместо _Main network_. У вас так-же должны быть токены MANA в тестовом блокчейне Ropsten, которые можно получить бесплатно.

Для предпросмотра сцены с использованием тестовой сети добавьте параметр `DEBUG` в адресную строку (URL) вашего браузера. Например, если ваша сцена доступна по адресу `http://127.0.0.1:8000/?position=0%2C-1`, то нужно добавить DEBUG, чтобы получилось `http://127.0.0.1:8000/?DEBUG&position=0%2C-1`.

Любые переводы валюты, которые вы совершите в режиме предпросмотра в этом случае будут происходить в тестовой сети, а не с настоящими токенами MANA.
